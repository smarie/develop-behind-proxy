
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../basics/">
      
      
        <link rel="next" href="../configure_apps/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>Know your proxy - develop-behind-proxy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#know-your-proxy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="develop-behind-proxy" class="md-header__button md-logo" aria-label="develop-behind-proxy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            develop-behind-proxy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Know your proxy
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/smarie/develop-behind-proxy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="develop-behind-proxy" class="md-nav__button md-logo" aria-label="develop-behind-proxy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    develop-behind-proxy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/smarie/develop-behind-proxy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        HTTP/HTTPs Proxy basics
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Know your proxy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Know your proxy
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-configuration-scripts" class="md-nav__link">
    Auto-configuration scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-proxies-that-modify-the-ssl-certification-chain" class="md-nav__link">
    Advanced: proxies that modify the SSL certification chain
  </a>
  
    <nav class="md-nav" aria-label="Advanced: proxies that modify the SSL certification chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-if-your-proxy-needs-to-be-trusted" class="md-nav__link">
    Check if your proxy needs to be trusted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-your-proxys-root-certificate" class="md-nav__link">
    Download your proxy's root certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-certificate-bundle-including-your-proxys-root-certificate" class="md-nav__link">
    Create a certificate bundle including your proxy's root certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../configure_apps/" class="md-nav__link">
        Configure your applications
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../switching/" class="md-nav__link">
        Switching tools
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-configuration-scripts" class="md-nav__link">
    Auto-configuration scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-proxies-that-modify-the-ssl-certification-chain" class="md-nav__link">
    Advanced: proxies that modify the SSL certification chain
  </a>
  
    <nav class="md-nav" aria-label="Advanced: proxies that modify the SSL certification chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-if-your-proxy-needs-to-be-trusted" class="md-nav__link">
    Check if your proxy needs to be trusted
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-your-proxys-root-certificate" class="md-nav__link">
    Download your proxy's root certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-certificate-bundle-including-your-proxys-root-certificate" class="md-nav__link">
    Create a certificate bundle including your proxy's root certificate
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="know-your-proxy">Know your proxy<a class="headerlink" href="#know-your-proxy" title="Permanent link">&para;</a></h1>
<p>Before configuring your computer applications to work with your proxy, you have to know which configuration settings to apply.</p>
<h2 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">&para;</a></h2>
<p>These can typically be obtained from your IT department:</p>
<ul>
<li>the proxy's <strong>host</strong> and <strong>port</strong> for the two protocols (HTTP and HTTPs). For example <code>http://proxyhost:8080</code> and <code>https://proxyhost:4443</code></li>
<li>the <strong>list of hosts that do not require a proxy</strong>, in other words the hosts for which the applications should still use a direct connection. These are typically computers located in the intranet, but also some external hosts that have been put in a 'whitelist' by your IT department. For example <code>localhost,127.0.0.1,mylocalserver</code></li>
<li>(optional) your credentials (<strong>username</strong> and <strong>password</strong>). Note that NTML proxies such as ZScaler do not require this - this is even dangerous in term of security to write your username and password in a file or an environment variable, so we don't recommend it</li>
</ul>
<h2 id="auto-configuration-scripts">Auto-configuration scripts<a class="headerlink" href="#auto-configuration-scripts" title="Permanent link">&para;</a></h2>
<p>Some tools are able to get their configuration with "auto-config" from a <code>.pac</code> script. If your organization provides such a script, make sure that you retrieve it.</p>
<h2 id="advanced-proxies-that-modify-the-ssl-certification-chain">Advanced: proxies that modify the SSL certification chain<a class="headerlink" href="#advanced-proxies-that-modify-the-ssl-certification-chain" title="Permanent link">&para;</a></h2>
<p>Some proxies such as <em>ZScaler</em> modify the SSL certification chain by replacing the root Certification Authority (CA)'s certificate signature with their own CA certificate. </p>
<p>In these cases, you will have to tell all your software applications to <strong>trust</strong> this new CA certificate. We will see below how to do that, but first let's check if you need it with your proxy.</p>
<h3 id="check-if-your-proxy-needs-to-be-trusted">Check if your proxy needs to be trusted<a class="headerlink" href="#check-if-your-proxy-needs-to-be-trusted" title="Permanent link">&para;</a></h3>
<p>To check if your proxy changes the certification chain, here is the procedure on <em>Firefox</em> (but you can probably find equivalent possibilities in other browsers):</p>
<ul>
<li>connect to any https page such as <a href="https://google.com">https://google.com</a></li>
<li>click on the small 'locker' icon at the left of the URL bar</li>
<li>extend the popup. It should state "secure connection, verified by <code>xxx</code>":</li>
</ul>
<p><img alt="Checking if your proxy changes the certification chain" src="../example2.png" /></p>
<ul>
<li>if <code>xxx</code> has the name of your proxy (in this example, <em>Zscaler</em>) instead of being a known certification authority (such as DigiCert, Thawte, Verisign, Symantec, etc.), that means that your proxy has modified the certification chain. Otherwise, that means that either your proxy does not modify it, or bad luck : you picked a site that is in the whitelist :) select another https url and try again, to be sure. </li>
</ul>
<h3 id="download-your-proxys-root-certificate">Download your proxy's root certificate<a class="headerlink" href="#download-your-proxys-root-certificate" title="Permanent link">&para;</a></h3>
<p>If the test was positive, you will need to download the proxy's CA certificate in order to be able to trust it. For this:</p>
<ul>
<li>Click on <code>More Information &gt; View Certificate &gt; Details</code>. </li>
</ul>
<p><img alt="Exporting the root certificate" src="../example3.png" /></p>
<ul>
<li>Select the ROOT certificate, at the top of the hierarchy - not the intermediate ones ! - and export it as a <code>*.crt</code> or <code>*.cer</code> file. If your browser asks you which certificate format is needed, select <code>base64</code>. This format is a string representation of the certificate's bytes, so you may open the file in Notepad and copy/paste the certificate easily if you need to.</li>
</ul>
<p>You now have a <code>my_proxys_root_ca_cert.cer</code> file. </p>
<p><em>Note: <code>.cer</code>, <code>.crt</code> and <code>.pem</code> are both valid extensions for such a <code>base64</code> encoded file, see <a href="https://support.ssl.com/Knowledgebase/Article/View/19/0/der-vs-crt-vs-cer-vs-pem-certificates-and-how-to-convert-them">this article</a>. They can be opened with a text editor if needed.</em></p>
<h3 id="create-a-certificate-bundle-including-your-proxys-root-certificate">Create a certificate bundle including your proxy's root certificate<a class="headerlink" href="#create-a-certificate-bundle-including-your-proxys-root-certificate" title="Permanent link">&para;</a></h3>
<p>As we'll see in the next session, some tools are able to support addition of trusted certificates one by one (= separate certificate files), while some others only support changing the whole trusted certificate bundle entirely (= a single file containing all trusted certificates). </p>
<p>You will therefore need to build such a certificate bundle file. This is done by appending your proxy's root certificate (<code>my_proxys_root_ca_cert.cer</code>, downloaded in previous section) to an <strong>existing</strong> certificate bundle.</p>
<ul>
<li>Get an existing certificate bundle. For example you may wish to get it from <a href="https://certifi.io/en/latest/">certifi</a> by downloading it from this adress: <a href="https://mkcert.org/generate/">certs.pem</a>. <strong>IMPORTANT</strong> please check that this link is still the link recommended by certifi.io! Downloading a compromised list of certificate authorities can enfringe your computer's (and IT dept) security rules, proceed with care and/or double-check with your IT department.</li>
<li>save the file somewhere on your computer, and rename it for example <code>160117-certifi-ca-bundle-with-proxy.pem</code>. Make sure that only administrator account has write permissions on this file. This will prevent programs to add other trusted certificates later on.</li>
<li>open it in your favorite text editor to edit it: at the end of the file, append your Proxy's certificate (the contents of the <code>my_proxys_root_ca_cert.cer</code> file downloaded in previous step). The bottom of the resulting certificate bundle file should therefore now look like this:</li>
</ul>
<div class="codehilite"><pre><span></span><code>(... end of the certs.pem file provided by certifi)
oyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq
4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA
mRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d
emyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=
-----END CERTIFICATE-----

My Proxy&#39;s Root CA
==================
-----BEGIN CERTIFICATE-----
MIAE07CCA7ugAwIBAgIJANu+mC2Jt3uTMA0GCSqGSIb3DQEBCwUAMIGhMQswCQYD
VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTERMA8GA1UEBxMIU2FuIEpvc2Ux
(... this is fairly long)
xFNjavxrHmsH8jPHVvgc1VD0Opja0l/BRVauTrUaoW6tE+wFG5rEcPGS80jjHK4S
pB5iDj2mUZH1T8lzYtuZy0ZPirxmtsk3135+CKNa2OCAhhFjE0xd
-----END CERTIFICATE-----
</code></pre></div>

<p>You are now all set :</p>
<ul>
<li>You have a <code>my_proxys_root_ca_cert.crt</code> file containing your proxy's certificate only. This will be referred to as <code>&lt;path_to_root_ca_cert.crt&gt;</code> in next section</li>
<li>You have a <code>160117-certifi-ca-bundle-with-proxy.pem</code> file containing a bundle of trusted certificates, as well as your proxy's. This will be referred to as <code>&lt;path_to_ca_bundle.pem&gt;</code> in next section</li>
</ul>
<p><em>(Remember that <code>.crt</code>, <code>.cer</code> and <code>.pem</code> are both valid extensions for these files)</em></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>